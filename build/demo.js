!function(t){function e(s){if(i[s])return i[s].exports;var a=i[s]={i:s,l:!1,exports:{}};return t[s].call(a.exports,a,a.exports,e),a.l=!0,a.exports}var i={};return e.m=t,e.c=i,e.i=function(t){return t},e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:s})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){"use strict";for(var s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,n=[],c="http://www.buick.com.cn/img/lacrosse_hev/360/red/",o=(window.BdVoice.search,window.BdVoice.Recognizer),r=36;r>=1;r--){var l=r;l<10&&(l="0"+l),n.push({class:"hide",width:s,src:c+l+".png"})}Vue.component("message-item",{props:["message"],template:'<div class="chat_item bounceIn animated">\n        <div :class="[message.pos, message.type]">\n            {{{message.content}}}\n        </div>\n    </div>'}),Vue.component("menu-item",{props:["menu"],template:'<a v-if="!menu.upload" onclick="{{menu.clickHandler}}" href="#">{{menu.hint}}</a>\n        <a v-if="menu.upload" href="#">\n            <input class="hide" type="file" id="menuFile" accept="images/*" />\n            <label for="file">上传</label>\n        </a>'}),Vue.component("imgs-item",{props:["img"],template:'<img widht="{{img.width}}" :src="img.src" class="{{img.class}}" />'}),Vue.component("top-thumb-imgs-item",{props:["img"],template:'<div class="display_top_bar_item"><div>'});var d=new Vue({el:"#wrapper",data:{voice2text:"",inputText:"",pageWidth:s,pageHeight:a,displayImgDom:document.querySelector(".display_img"),displayImg360Dom:document.querySelector(".display_img360"),chatListDom:document.querySelector(".chat_list"),audioSrcPrefix:"http://tts.baidu.com/text2audio?lan=zh&pid=101&ie=UTF-8&text=",audioSrc:"http://tts.baidu.com/text2audio?lan=zh&pid=101&ie=UTF-8&text=Hi%252C%25E4%25BD%25A0%25E5%25A5%25BD%252C%25E6%2588%2591%25E6%2598%25AF%25E5%25BA%25A6%25E7%25A7%2598",audioText:"",firstImg:!0,messageList:[{content:"<p>Hi,你好,我是度秘!</p>",pos:"left"}],tipsIndex:0,tplList:{singleText:"<p>小度暂时还没有听懂</p>",singleCard:'<div class="chat_card">\n                <div class="card_title">\n                    轿车(car)\n                </div>\n                <div class="card_img">\n                    <img width="300" src="img/result_img.png" />\n                </div>\n                <div class="card_bottom_bar">\n                    <a class="flash animated" href="#">百科</a>\n                    <a class="flash animated" href="#">汽车之家</a>\n                    <a class="flash animated" href="#">经销商</a>\n                </div>\n            </div>',singleTips:'<div class="chat_card single_tips">\n                <div class="card_title">\n                    拍下车的前脸和侧面,小度可以更精准帮你识别哦\n                </div>\n                <div class="card_img flash animated" onclick="chatDom.displayTipsImg(\'origin\')"></div>\n            </div>',singleResultCard:'<div class="chat_card result">\n                <div class="card_title">别克-君越</div>\n                <div class="card_img" onclick="chatDom.displayCar360()">\n                    <img class="flash animated" width="200" src="img/buick_car_side.jpg" />\n                </div>\n                <div class="card_bottom_bar">\n                    <a class="flash animated" href="#">价格</a>\n                    <a class="flash animated" href="#">参数</a>\n                    <a class="flash animated" href="#">其他车型</a>\n                    <a class="flash animated" href="#">经销商</a>\n                </div>\n            </div>',multicard:'<div class="multicard_wrapper">\n                <div class="multicard_item">\n                    <p>前脸</p>\n                    <img src="img/car_front_small.jpg" />\n                </div>\n                <div class="multicard_item">\n                    <p>侧视图</p>\n                    <img src="img/car_side_small.jpg" />\n                </div>\n                <div class="multicard_item">\n                    <p>背面</p>\n                    <img src="img/car_back_small.jpg" />\n                </div>\n                <div class="multicard_item">\n                    <p>原图</p>\n                    <img src="img/car_side45_small.jpg" />\n                </div>\n            </div>'},menu:!1,menuList:[{hint:"车型是什么",clickHandler:'chatDom.addText("车型是什么")'},{hint:"价格多少"},{hint:"小度猜错了"}],timer:null,display360:!1,srcList:n,transClass:"",transScanClass:"",topImageHideObj:{back:"hide",front:"hide",side:"hide"}},methods:{addText:function(t){var e=this.inputText.trim();t&&(e=t),e&&(this.messageList.push({type:"text",content:"<p>"+e+"</p>",pos:"right"}),this.inputText="",this.fakeReply())},addImg:function(t){var e=t.target.files[0],i=new FileReader,s=this;i.readAsDataURL(e),i.onload=function(){d.messageList.push({type:"img",content:"<img src="+this.result+' /><div class="scan_line"></div>',pos:"right"}),s.fakeReply()}},addVoice:function(t){p.start()},fakeReply:function(t){var e=this,i=e.messageList[e.messageList.length-1],s=(2e6*Math.random()).toString(36),a=[],n=[],c=!1;switch(t=t||i.type,e.firstImg=!1,t){case"text":i.content.match("车型")||i.content.match("型号")||i.content.match("价格")||i.content.match("钱")?(n.push(""),a.push("singleTips")):i.content.match("result")?a.push("singleResultCard"):i.content.match("scroll")?(a.push("multicard"),n.push("multicard")):i.content.match("menu")?e.menu=!0:a.push("singleText");break;case"img":a.push("singleCard"),c=!0;break;case"menu":a.push("multicard");break;case"car_model":n.push(""),a.push("singleTips"),e.audioText="拍下车的前脸和侧面,小度可以更精准帮你识别哦";break;case"multicard":n.push("multicard"),a.push("multicard");break;case"result":n.push(""),a.push("singleResultCard")}var o=0;a.map(function(t){setTimeout(function(){d.messageList.push({type:n[o],content:e.tplList[t],pos:"left"}),e.autoScroll(),"singleTips"===t&&(e.audioSrc=e.audioSrcPrefix+encodeURIComponent(encodeURIComponent(e.audioText))+"&dri"+s),e.menu=c===!0,o++},1500)})},autoScroll:function(){var t=this;setTimeout(function(){t.chatListDom.scrollHeight>t.chatListDom.offsetHeight&&(t.chatListDom.scrollTop=t.chatListDom.scrollHeight-t.chatListDom.offsetHeight)},300)},reply:function(){console.log("real reply")},displayTipsImg:function(t,e){var i=this,s={front:"img/car_front.jpg",side:"img/car_side.jpg",back:"img/car_back.jpg",origin:"img/first_origin.jpg"};switch(i.topImageHideObj[t]="",i.display360=!1,i.displayImgDom.style.cssText="top:0;background-image: url("+s[t]+")",t){case"origin":i.audioText="拍下车的前脸,侧面和背面";break;case"front":i.audioText="请拍侧面照";break;case"side":i.audioText="请拍背面"}i.audioSrc=i.audioSrcPrefix+encodeURIComponent(encodeURIComponent(i.audioText))},displayCar360:function(){var t=0,e=this;e.displayImgDom.style.cssText="top:0;background: #FFF;",e.display360=!0,e.audioText="这款车型是别克君越2016款,它的最低配价格是22.98万",e.audioSrc=e.audioSrcPrefix+encodeURIComponent(encodeURIComponent(e.audioText)),e.timer=setInterval(function(){36===t&&(t=0),e.srcList=e.srcList.map(function(t){return t.class="hide",t}),e.srcList[t].class="",t++},88)},hideTipsImg:function(){var t=this;t.displayImgDom.style.top="100%",t.fakeReply("multicard"),setTimeout(function(){t.fakeReply("result")},800),t.timer&&(t.timer=clearInterval(t.timer)),t.display360&&(t.display360=!1)},hideFirstImg:function(){var t=this;t.displayImgDom.style.top="100%",t.firstImg&&(t.messageList.push({type:"img",content:'<img src="img/car_origin_small.jpg"/><div class="scan_line"></div>',pos:"right"}),t.fakeReply("img"))},onlyhideTips:function(){var t=this;t.displayImgDom.style.cssText="top:100%;",t.transClass="",t.topImageHideObj={back:"hide",front:"hide",side:"hide",origin:"hide"},t.transScanClass="",t.timer&&(t.timer=clearInterval(t.timer))},postText:function(t){var e=this;$.ajax({type:"post",url:"http://127.0.0.1:8878/json",data:{type:"text",content:t||"询问其他图片",user_id:123456},dataType:"json"}).done(function(t){e.handleRes(t),console.log("内容保存成功")}).fail(function(){console.log("内容保存失败")})},handleRes:function(t){var e=this;e.menuList=[],e.menu=!0,t.hint.map(function(t){var i=!1;t.match("拍摄")&&(i=!0),e.menuList.push({hint:t,upload:i,clickHandler:"chatDom.menuClickHandler(this)"})}),e.messageList.push({type:"text",content:"<p>"+t.text+"</p>",pos:"left"})},menuClickHandler:function(t){t&&t.innerHTML&&this.postText(t.innerHTML)},postImg:function(t){var e=this;$.ajax({type:"post",url:"http://127.0.0.1:8878/json",data:{type:"image",content:t,user_id:123456},dataType:"json"}).done(function(t){e.handleRes(t),console.log("内容保存成功")}).fail(function(){console.log("内容保存失败")})},addTransClass:function(){var t=this;t.transClass="display_top_bar_item_trans",setTimeout(function(){t.transScanClass="scan_line",t.fakeReply("multicard"),setTimeout(function(){t.fakeReply("result")},800),setTimeout(function(){t.transClass="display_top_bar_item_trans fadeOut animated",t.displayCar360()},3e3)},1e3)}}});d.srcList=n,window.chatDom=d;var m=new Vue({el:"#wrapperList",data:{index:0,pageLength:13,demoPageIndex:8,pageWidth:s,posStyle:""},methods:{posHandler:function(){this.index>this.pageLength-1&&(this.index=this.pageLength-1),this.index<0&&(this.index=0),this.index===this.demoPageIndex?document.querySelector(".input_area").style.cssText="display:block;":document.querySelector(".input_area").style.cssText="display:none;";var t=this.index*this.pageWidth;this.posStyle="left: -"+t+"px"},nextPage:function(){this.index++,this.posHandler()},prePage:function(){this.index--,this.posHandler()}}});window.pageDom=m;var p=new o({pluginOptions:{show_voiceUI:"1",voiceSource:"sound_channel"}}).on("recognizing",function(t){var e='<span class="glyphicon glyphicon-volume-up"></span>'+t.data.result||"";d.messageList.push({type:"text",content:"<p>"+e+"</p>",pos:"right"}),d.fakeReply()})}]);